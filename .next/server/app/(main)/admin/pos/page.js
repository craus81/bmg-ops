(()=>{var e={};e.id=531,e.ids=[531],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1595:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>x,tree:()=>d}),i(5506),i(8522),i(5866),i(2029);var n=i(3191),r=i(8716),s=i(7922),a=i.n(s),l=i(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);i.d(t,o);let d=["",{children:["(main)",{children:["admin",{children:["pos",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(i.bind(i,5506)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/admin/pos/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(i.bind(i,8522)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(i.t.bind(i,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(i.bind(i,2029)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(i.t.bind(i,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/admin/pos/page.tsx"],p="/(main)/admin/pos/page",u={require:i,loadChunk:()=>Promise.resolve()},x=new n.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(main)/admin/pos/page",pathname:"/admin/pos",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7227:(e,t,i)=>{Promise.resolve().then(i.t.bind(i,2994,23)),Promise.resolve().then(i.t.bind(i,6114,23)),Promise.resolve().then(i.t.bind(i,9727,23)),Promise.resolve().then(i.t.bind(i,9671,23)),Promise.resolve().then(i.t.bind(i,1868,23)),Promise.resolve().then(i.t.bind(i,4759,23))},362:(e,t,i)=>{Promise.resolve().then(i.bind(i,3876))},9378:(e,t,i)=>{Promise.resolve().then(i.bind(i,5236))},6533:()=>{},5047:(e,t,i)=>{"use strict";var n=i(7389);i.o(n,"useParams")&&i.d(t,{useParams:function(){return n.useParams}}),i.o(n,"usePathname")&&i.d(t,{usePathname:function(){return n.usePathname}}),i.o(n,"useRouter")&&i.d(t,{useRouter:function(){return n.useRouter}}),i.o(n,"useSearchParams")&&i.d(t,{useSearchParams:function(){return n.useSearchParams}})},3876:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>o});var n=i(326),r=i(7577),s=i(5047),a=i(1944),l=i(2567);function o(){let e=(0,s.useRouter)(),{isAdmin:t,user:i}=(0,l.a)(),o=(0,a.e)(),[p,u]=(0,r.useState)([]),[x,h]=(0,r.useState)([]),[m,g]=(0,r.useState)(!0),[f,b]=(0,r.useState)(!1),[y,v]=(0,r.useState)(null),[j,_]=(0,r.useState)({po_number:"",customer:"Masterack"}),[S,k]=(0,r.useState)([]),w=e=>{let t=x.find(t=>t.id===e);t&&k(e=>[...e,{catalog_id:t.id,part_number:t.part_number,quantity:1,unit_price:t.price}])},P=async()=>{if(!j.po_number||!j.customer||0===S.length||!i)return;let{data:e,error:t}=await o.from("purchase_orders").insert({po_number:j.po_number,customer:j.customer,created_by:i.id}).select().single();if(!e||t){alert("Error: "+t?.message);return}let{data:n}=await o.from("po_line_items").insert(S.map(t=>({po_id:e.id,...t}))).select();u(t=>[{...e,line_items:n||[]},...t]),_({po_number:"",customer:"Masterack"}),k([]),b(!1)},C=e=>{v(y===e?null:e)},D=e=>"$"+e.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",");return m?n.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#4a5f78"},children:"Loading..."}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[(0,n.jsxs)("div",{style:{fontSize:"11px",fontWeight:700,color:"#4a5f78",textTransform:"uppercase",letterSpacing:"0.5px"},children:["Purchase Orders (",p.length,")"]}),n.jsx("button",{onClick:()=>b(!f),style:{padding:"6px 12px",borderRadius:"8px",background:"#3b82f6",color:"#fff",fontSize:"12px",fontWeight:700,border:"none"},children:f?"Cancel":"+ New PO"})]}),f&&(0,n.jsxs)("div",{style:{background:"#141e2b",border:"1px solid #1e2d3d",borderRadius:"10px",padding:"14px",marginBottom:"12px"},children:[(0,n.jsxs)("div",{style:{marginBottom:"8px"},children:[n.jsx("label",{style:d,children:"PO Number"}),n.jsx("input",{value:j.po_number,onChange:e=>_({...j,po_number:e.target.value}),style:c})]}),(0,n.jsxs)("div",{style:{marginBottom:"8px"},children:[n.jsx("label",{style:d,children:"Customer"}),(0,n.jsxs)("select",{value:j.customer,onChange:e=>_({...j,customer:e.target.value}),style:c,children:[n.jsx("option",{children:"Masterack"}),n.jsx("option",{children:"Knapheide"}),n.jsx("option",{children:"Bodewell"}),n.jsx("option",{children:"Designs That Stick"})]})]}),(0,n.jsxs)("div",{style:{marginBottom:"8px"},children:[n.jsx("label",{style:d,children:"Add Part Number"}),(0,n.jsxs)("select",{onChange:e=>{e.target.value&&w(e.target.value),e.target.value=""},style:c,children:[n.jsx("option",{value:"",children:"Select part number..."}),x.filter(e=>e.customer===j.customer).map(e=>(0,n.jsxs)("option",{value:e.id,children:[e.part_number," — ",e.end_customer," ($",e.price,")"]},e.id))]})]}),S.length>0&&(0,n.jsxs)("div",{style:{marginBottom:"8px"},children:[S.map((e,t)=>(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 0",borderBottom:"1px solid #1e2d3d"},children:[n.jsx("div",{style:{flex:1,fontSize:"13px",fontWeight:700},children:e.part_number}),n.jsx("div",{style:{fontSize:"12px",color:"#4a5f78"},children:D(e.unit_price)}),n.jsx("input",{type:"number",value:e.quantity,onChange:e=>{let i=parseInt(e.target.value)||1;k(e=>e.map((e,n)=>n===t?{...e,quantity:i}:e))},style:{...c,width:"60px",textAlign:"center"},min:1}),n.jsx("button",{onClick:()=>k(e=>e.filter((e,i)=>i!==t)),style:{color:"#f87171",fontSize:"18px",padding:"0 4px",background:"none",border:"none"},children:"\xd7"})]},t)),(0,n.jsxs)("div",{style:{textAlign:"right",marginTop:"6px",fontSize:"13px",fontWeight:700,color:"#60a5fa"},children:["Total: ",D(S.reduce((e,t)=>e+t.quantity*t.unit_price,0))]})]}),n.jsx("button",{onClick:P,disabled:!j.po_number||0===S.length,style:{width:"100%",padding:"12px",borderRadius:"10px",background:"#22c55e",color:"#fff",fontWeight:800,fontSize:"14px",border:"none",opacity:j.po_number&&S.length>0?1:.4},children:"Create PO"})]}),0===p.length&&(0,n.jsxs)("div",{style:{textAlign:"center",padding:"32px 0",color:"#4a5f78"},children:[n.jsx("div",{style:{fontSize:"36px",marginBottom:"6px",opacity:.4},children:"\uD83D\uDCCB"}),n.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:"No purchase orders yet"})]}),p.map(e=>{let t=e.line_items.reduce((e,t)=>e+t.quantity,0),i=e.line_items.reduce((e,t)=>e+t.installed,0),r=e.line_items.reduce((e,t)=>e+t.quantity*t.unit_price,0),s=t>0?i/t*100:0,a=y===e.id,l=new Date(e.created_at);return(0,n.jsxs)("div",{style:{background:"#141e2b",border:"1px solid #1e2d3d",borderRadius:"10px",marginBottom:"6px",overflow:"hidden"},children:[(0,n.jsxs)("div",{onClick:()=>C(e.id),style:{padding:"12px",cursor:"pointer"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{fontWeight:800,fontSize:"15px"},children:["PO #",e.po_number]}),(0,n.jsxs)("div",{style:{fontSize:"12px",color:"#4a5f78",marginTop:"1px"},children:[e.customer," • ",e.line_items.length," item",1!==e.line_items.length?"s":"","complete"===e.status&&n.jsx("span",{style:{color:"#4ade80",marginLeft:"6px"},children:"✓ Complete"})]})]}),(0,n.jsxs)("div",{style:{textAlign:"right"},children:[n.jsx("div",{style:{fontSize:"14px",fontWeight:800,color:"#60a5fa"},children:D(r)}),(0,n.jsxs)("div",{style:{fontSize:"10px",color:"#4a5f78",marginTop:"1px"},children:[a?"▲":"▼"," Details"]})]})]}),(0,n.jsxs)("div",{style:{marginTop:"8px"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"11px",marginBottom:"3px"},children:[n.jsx("span",{style:{color:"#4a5f78"},children:"Progress"}),(0,n.jsxs)("span",{style:{color:s>=100?"#4ade80":"#60a5fa",fontWeight:700},children:[i,"/",t]})]}),n.jsx("div",{style:{height:"6px",background:"#1e2d3d",borderRadius:"3px"},children:n.jsx("div",{style:{height:"100%",width:`${Math.min(s,100)}%`,background:s>=100?"#22c55e":"#3b82f6",borderRadius:"3px",transition:"width 0.3s"}})})]})]}),a&&(0,n.jsxs)("div",{style:{borderTop:"1px solid #1e2d3d",padding:"10px 12px"},children:[(0,n.jsxs)("div",{style:{fontSize:"10px",color:"#4a5f78",marginBottom:"2px"},children:["Created ",l.toLocaleDateString([],{month:"short",day:"numeric",year:"numeric"})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"4px",padding:"8px 0 4px",borderBottom:"1px solid #1e2d3d",fontSize:"10px",fontWeight:700,color:"#4a5f78",textTransform:"uppercase",letterSpacing:"0.3px"},children:[n.jsx("div",{style:{flex:1},children:"Part #"}),n.jsx("div",{style:{width:"36px",textAlign:"center"},children:"Qty"}),n.jsx("div",{style:{width:"42px",textAlign:"center"},children:"Done"}),n.jsx("div",{style:{width:"65px",textAlign:"right"},children:"Price"}),n.jsx("div",{style:{width:"75px",textAlign:"right"},children:"Line Total"})]}),e.line_items.map(e=>{let t=e.quantity*e.unit_price,i=e.quantity>0?e.installed/e.quantity*100:0;return(0,n.jsxs)("div",{style:{display:"flex",gap:"4px",padding:"8px 0",borderBottom:"1px solid rgba(30,45,61,0.5)",alignItems:"center",fontSize:"12px"},children:[(0,n.jsxs)("div",{style:{flex:1},children:[n.jsx("div",{style:{fontWeight:700,color:"#e8ecf1"},children:e.part_number}),n.jsx("div",{style:{height:"3px",background:"#1e2d3d",borderRadius:"2px",marginTop:"3px",width:"80%"},children:n.jsx("div",{style:{height:"100%",width:`${Math.min(i,100)}%`,background:i>=100?"#22c55e":"#3b82f6",borderRadius:"2px"}})})]}),n.jsx("div",{style:{width:"36px",textAlign:"center",color:"#6b7a8d",fontWeight:600},children:e.quantity}),n.jsx("div",{style:{width:"42px",textAlign:"center",fontWeight:700,color:e.installed>=e.quantity?"#4ade80":"#fbbf24"},children:e.installed}),n.jsx("div",{style:{width:"65px",textAlign:"right",color:"#6b7a8d",fontSize:"11px"},children:D(e.unit_price)}),n.jsx("div",{style:{width:"75px",textAlign:"right",fontWeight:700,color:"#e8ecf1"},children:D(t)})]},e.id)}),(0,n.jsxs)("div",{style:{display:"flex",gap:"4px",padding:"10px 0 4px",fontSize:"13px"},children:[n.jsx("div",{style:{flex:1,fontWeight:800,color:"#e8ecf1"},children:"Total"}),n.jsx("div",{style:{width:"36px",textAlign:"center",fontWeight:700,color:"#6b7a8d"},children:t}),n.jsx("div",{style:{width:"42px",textAlign:"center",fontWeight:700,color:i>=t?"#4ade80":"#60a5fa"},children:i}),n.jsx("div",{style:{width:"65px"}}),n.jsx("div",{style:{width:"75px",textAlign:"right",fontWeight:800,color:"#60a5fa"},children:D(r)})]})]})]},e.id)}),n.jsx("button",{onClick:()=>e.push("/more"),style:{width:"100%",padding:"10px",borderRadius:"10px",marginTop:"14px",border:"1px solid #1e2d3d",background:"transparent",color:"#6b7a8d",fontSize:"13px",fontWeight:700},children:"← Back"})]})}let d={display:"block",fontSize:"10px",fontWeight:700,color:"#4a5f78",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"4px"},c={width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #1e2d3d",background:"#0f1720",color:"#e8ecf1",fontSize:"13px"}},5236:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>p});var n=i(326),r=i(2567),s=i(2064);function a({clockStatus:e,activePartNumber:t,activeEndCustomer:i}){let{profile:s,isAdmin:a}=(0,r.a)(),l="in"===e?"\uD83D\uDFE2 Clocked In":"break"===e?"\uD83D\uDFE1 On Break":t?`${t} • ${i}`:"";return(0,n.jsxs)("header",{style:{background:"#141e2b",borderBottom:"1px solid #1e2d3d",padding:"12px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",position:"sticky",top:0,zIndex:100},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,fontSize:"11px",color:"#fff"},children:"BMG"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{style:{fontWeight:700,fontSize:"14px"},children:"BMG Ops"}),n.jsx("span",{style:{background:a?"rgba(139,92,246,0.12)":"rgba(59,130,246,0.12)",border:`1px solid ${a?"rgba(139,92,246,0.3)":"rgba(59,130,246,0.3)"}`,borderRadius:"5px",color:a?"#a78bfa":"#60a5fa",padding:"2px 6px",fontSize:"9px",fontWeight:700},children:a?"Admin":"Crew"})]}),l&&n.jsx("div",{style:{fontSize:"10px",color:"#4a5f78"},children:l})]})]}),n.jsx("div",{style:{fontSize:"11px",color:"#4a5f78"},children:s?.full_name})]})}var l=i(5047);let o=[{id:"home",path:"/home",label:"Home",icon:"\uD83C\uDFE0"},{id:"time",path:"/time",label:"Time Clock",icon:"⏰"},{id:"vehicles",path:"/vehicles",label:"Vehicles",icon:"\uD83D\uDE90"},{id:"more",path:"/more",label:"More",icon:"⋯"}];function d({clockStatus:e}){let t=(0,l.usePathname)(),i=(0,l.useRouter)(),r=t=>{if("time"===t.id){if("in"===e)return"\uD83D\uDFE2";if("break"===e)return"\uD83D\uDFE1"}return t.icon},s=e=>"/home"===e.path?"/home"===t||"/scan"===t||"/select-part"===t||"/photos"===t:t.startsWith(e.path);return n.jsx("nav",{style:{position:"fixed",bottom:0,left:0,right:0,background:"#141e2b",borderTop:"1px solid #1e2d3d",display:"flex",zIndex:100,paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:o.map(e=>(0,n.jsxs)("button",{onClick:()=>i.push(e.path),style:{flex:1,padding:"8px 4px 10px",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px",color:s(e)?"#60a5fa":"#4a5f78"},children:[n.jsx("div",{style:{fontSize:"18px"},children:r(e)}),n.jsx("div",{style:{fontSize:"10px",fontWeight:700},children:e.label})]},e.id))})}function c({children:e}){let{loading:t}=(0,r.a)(),{clockStatus:i,activePart:l,appLoading:o}=(0,s.q)();return t||o?n.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsxs)("div",{style:{textAlign:"center"},children:[n.jsx("div",{style:{width:"36px",height:"36px",border:"3px solid #1e2d3d",borderTopColor:"#3b82f6",borderRadius:"50%",margin:"0 auto",animation:"spin 1s linear infinite"}}),n.jsx("div",{style:{color:"#4a5f78",marginTop:"12px",fontSize:"13px"},children:"Loading..."})]})}):(0,n.jsxs)("div",{style:{minHeight:"100vh",paddingBottom:"70px"},children:[n.jsx(a,{clockStatus:i,activePartNumber:l?.part_number,activeEndCustomer:l?.end_customer}),n.jsx("div",{style:{maxWidth:"500px",margin:"0 auto",padding:"14px 20px"},children:e}),n.jsx(d,{clockStatus:i})]})}function p({children:e}){return n.jsx(r.H,{children:n.jsx(s.w,{children:n.jsx(c,{children:e})})})}},2064:(e,t,i)=>{"use strict";i.d(t,{q:()=>d,w:()=>o});var n=i(326),r=i(7577),s=i(1944),a=i(2567);let l=(0,r.createContext)({});function o({children:e}){let{user:t}=(0,a.a)(),i=(0,s.e)(),[o,d]=(0,r.useState)("out"),[c,p]=(0,r.useState)(null),[u,x]=(0,r.useState)(null),[h,m]=(0,r.useState)([]),[g,f]=(0,r.useState)(0),[b,y]=(0,r.useState)(null),[v,j]=(0,r.useState)(null),[_,S]=(0,r.useState)(!0),k=(0,r.useCallback)(async()=>{if(!t)return;let e=new Date().toISOString(),{data:n,error:r}=await i.from("time_entries").insert({user_id:t.id,clock_in:e,status:"clocked_in"}).select().single();n&&!r&&(y(n),p(e),m([]),d("in"),f(0))},[t,i]),w=(0,r.useCallback)(async()=>{if(!b)return;let e=new Date().toISOString(),{data:t}=await i.from("time_breaks").insert({time_entry_id:b.id,break_start:e}).select().single();await i.from("time_entries").update({status:"on_break"}).eq("id",b.id),t&&(m(e=>[...e,t]),x(e),d("break"))},[b,i]),P=(0,r.useCallback)(async()=>{if(!b||!u)return;let e=new Date().toISOString(),t=h.find(e=>!e.break_end);t&&(await i.from("time_breaks").update({break_end:e}).eq("id",t.id),m(i=>i.map(i=>i.id===t.id?{...i,break_end:e}:i))),await i.from("time_entries").update({status:"clocked_in"}).eq("id",b.id),x(null),d("in")},[b,u,h,i]),C=(0,r.useCallback)(async()=>{if(!b||!c)return;let e=new Date,t=e.toISOString(),n=h.find(e=>!e.break_end);n&&await i.from("time_breaks").update({break_end:t}).eq("id",n.id);let r=e.getTime()-new Date(c).getTime();h.map(e=>({...e,break_end:e.break_end||t})).forEach(e=>{r-=new Date(e.break_end).getTime()-new Date(e.break_start).getTime()}),await i.from("time_entries").update({clock_out:t,status:"clocked_out",total_ms:Math.max(0,r)}).eq("id",b.id),d("out"),p(null),x(null),m([]),f(0),y(null)},[b,c,h,i]);return n.jsx(l.Provider,{value:{clockStatus:o,clockInTime:c,breakStartTime:u,currentBreaks:h,elapsed:g,activeTimeEntry:b,doClockIn:k,doStartBreak:w,doEndBreak:P,doClockOut:C,activePart:v,setActivePart:j,appLoading:_},children:e})}let d=()=>(0,r.useContext)(l)},2567:(e,t,i)=>{"use strict";i.d(t,{H:()=>l,a:()=>o});var n=i(326),r=i(7577),s=i(1944);let a=(0,r.createContext)({user:null,profile:null,isAdmin:!1,loading:!0,signOut:async()=>{}});function l({children:e}){let[t,i]=(0,r.useState)(null),[l,o]=(0,r.useState)(null),[d,c]=(0,r.useState)(!0),p=(0,s.e)(),u=async()=>{await p.auth.signOut(),i(null),o(null)};return n.jsx(a.Provider,{value:{user:t,profile:l,isAdmin:l?.role==="admin",loading:d,signOut:u},children:e})}let o=()=>(0,r.useContext)(a)},1944:(e,t,i)=>{"use strict";i.d(t,{e:()=>r});var n=i(861);function r(){return(0,n.createBrowserClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},5506:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>n});let n=(0,i(8570).createProxy)(String.raw`/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/admin/pos/page.tsx#default`)},8522:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>n});let n=(0,i(8570).createProxy)(String.raw`/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/layout.tsx#default`)},2029:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a,metadata:()=>r,viewport:()=>s});var n=i(9510);i(5023);let r={title:"BMG Ops",description:"BMG Fleet Installations Operations App",manifest:"/manifest.json",appleWebApp:{capable:!0,statusBarStyle:"black-translucent",title:"BMG Ops"}},s={width:"device-width",initialScale:1,maximumScale:1,userScalable:!1,themeColor:"#0f1720"};function a({children:e}){return(0,n.jsxs)("html",{lang:"en",children:[n.jsx("head",{children:n.jsx("link",{rel:"apple-touch-icon",href:"/icon-192.png"})}),n.jsx("body",{children:e})]})}},5023:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),n=t.X(0,[276,471,861],()=>i(1595));module.exports=n})();