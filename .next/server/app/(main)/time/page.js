(()=>{var e={};e.id=983,e.ids=[983],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8932:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GlobalError:()=>s.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d}),i(2716),i(8522),i(5866),i(2029);var r=i(3191),n=i(8716),a=i(7922),s=i.n(a),o=i(5231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);i.d(t,l);let d=["",{children:["(main)",{children:["time",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(i.bind(i,2716)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/time/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(i.bind(i,8522)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(i.t.bind(i,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(i.bind(i,2029)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(i.t.bind(i,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/time/page.tsx"],p="/(main)/time/page",x={require:i,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(main)/time/page",pathname:"/time",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7227:(e,t,i)=>{Promise.resolve().then(i.t.bind(i,2994,23)),Promise.resolve().then(i.t.bind(i,6114,23)),Promise.resolve().then(i.t.bind(i,9727,23)),Promise.resolve().then(i.t.bind(i,9671,23)),Promise.resolve().then(i.t.bind(i,1868,23)),Promise.resolve().then(i.t.bind(i,4759,23))},9378:(e,t,i)=>{Promise.resolve().then(i.bind(i,5236))},2220:(e,t,i)=>{Promise.resolve().then(i.bind(i,7898))},6533:()=>{},5047:(e,t,i)=>{"use strict";var r=i(7389);i.o(r,"useParams")&&i.d(t,{useParams:function(){return r.useParams}}),i.o(r,"usePathname")&&i.d(t,{usePathname:function(){return r.usePathname}}),i.o(r,"useRouter")&&i.d(t,{useRouter:function(){return r.useRouter}}),i.o(r,"useSearchParams")&&i.d(t,{useSearchParams:function(){return r.useSearchParams}})},5236:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>p});var r=i(326),n=i(2567),a=i(2064);function s({clockStatus:e,activePartNumber:t,activeEndCustomer:i}){let{profile:a,isAdmin:s}=(0,n.a)(),o="in"===e?"\uD83D\uDFE2 Clocked In":"break"===e?"\uD83D\uDFE1 On Break":t?`${t} • ${i}`:"";return(0,r.jsxs)("header",{style:{background:"#141e2b",borderBottom:"1px solid #1e2d3d",padding:"12px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",position:"sticky",top:0,zIndex:100},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[r.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,fontSize:"11px",color:"#fff"},children:"BMG"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[r.jsx("span",{style:{fontWeight:700,fontSize:"14px"},children:"BMG Ops"}),r.jsx("span",{style:{background:s?"rgba(139,92,246,0.12)":"rgba(59,130,246,0.12)",border:`1px solid ${s?"rgba(139,92,246,0.3)":"rgba(59,130,246,0.3)"}`,borderRadius:"5px",color:s?"#a78bfa":"#60a5fa",padding:"2px 6px",fontSize:"9px",fontWeight:700},children:s?"Admin":"Crew"})]}),o&&r.jsx("div",{style:{fontSize:"10px",color:"#4a5f78"},children:o})]})]}),r.jsx("div",{style:{fontSize:"11px",color:"#4a5f78"},children:a?.full_name})]})}var o=i(5047);let l=[{id:"home",path:"/home",label:"Home",icon:"\uD83C\uDFE0"},{id:"time",path:"/time",label:"Time Clock",icon:"⏰"},{id:"vehicles",path:"/vehicles",label:"Vehicles",icon:"\uD83D\uDE90"},{id:"more",path:"/more",label:"More",icon:"⋯"}];function d({clockStatus:e}){let t=(0,o.usePathname)(),i=(0,o.useRouter)(),n=t=>{if("time"===t.id){if("in"===e)return"\uD83D\uDFE2";if("break"===e)return"\uD83D\uDFE1"}return t.icon},a=e=>"/home"===e.path?"/home"===t||"/scan"===t||"/select-part"===t||"/photos"===t:t.startsWith(e.path);return r.jsx("nav",{style:{position:"fixed",bottom:0,left:0,right:0,background:"#141e2b",borderTop:"1px solid #1e2d3d",display:"flex",zIndex:100,paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:l.map(e=>(0,r.jsxs)("button",{onClick:()=>i.push(e.path),style:{flex:1,padding:"8px 4px 10px",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px",color:a(e)?"#60a5fa":"#4a5f78"},children:[r.jsx("div",{style:{fontSize:"18px"},children:n(e)}),r.jsx("div",{style:{fontSize:"10px",fontWeight:700},children:e.label})]},e.id))})}function c({children:e}){let{loading:t}=(0,n.a)(),{clockStatus:i,activePart:o,appLoading:l}=(0,a.q)();return t||l?r.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsxs)("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{width:"36px",height:"36px",border:"3px solid #1e2d3d",borderTopColor:"#3b82f6",borderRadius:"50%",margin:"0 auto",animation:"spin 1s linear infinite"}}),r.jsx("div",{style:{color:"#4a5f78",marginTop:"12px",fontSize:"13px"},children:"Loading..."})]})}):(0,r.jsxs)("div",{style:{minHeight:"100vh",paddingBottom:"70px"},children:[r.jsx(s,{clockStatus:i,activePartNumber:o?.part_number,activeEndCustomer:o?.end_customer}),r.jsx("div",{style:{maxWidth:"500px",margin:"0 auto",padding:"14px 20px"},children:e}),r.jsx(d,{clockStatus:i})]})}function p({children:e}){return r.jsx(n.H,{children:r.jsx(a.w,{children:r.jsx(c,{children:e})})})}},7898:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>c});var r=i(326),n=i(7577),a=i(2064),s=i(2567),o=i(1944);function l(e){return`${Math.floor(e/36e5)}h ${Math.floor(e%36e5/6e4).toString().padStart(2,"0")}m`}function d(e){return e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function c(){let[e,t]=(0,n.useState)("clock");return(0,r.jsxs)("div",{children:[r.jsx("div",{style:{display:"flex",gap:"6px",marginBottom:"16px"},children:[{id:"clock",label:"Clock"},{id:"history",label:"History"},{id:"week",label:"Week"}].map(i=>r.jsx("button",{onClick:()=>t(i.id),style:{flex:1,padding:"8px",borderRadius:"8px",fontSize:"12px",fontWeight:700,background:e===i.id?"rgba(59,130,246,0.12)":"transparent",border:e===i.id?"1px solid rgba(59,130,246,0.3)":"1px solid #1e2d3d",color:e===i.id?"#60a5fa":"#4a5f78"},children:i.label},i.id))}),"clock"===e&&r.jsx(p,{}),"history"===e&&r.jsx(x,{}),"week"===e&&r.jsx(u,{})]})}function p(){let{clockStatus:e,elapsed:t,clockInTime:i,breakStartTime:n,currentBreaks:s,doClockIn:o,doStartBreak:c,doEndBreak:p,doClockOut:x}=(0,a.q)();return(0,r.jsxs)("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{width:"140px",height:"140px",borderRadius:"50%",margin:"10px auto 20px",background:"out"===e?"rgba(255,255,255,0.03)":"break"===e?"rgba(245,158,11,0.08)":"rgba(34,197,94,0.08)",border:`3px solid ${"out"===e?"#1e2d3d":"break"===e?"rgba(245,158,11,0.3)":"rgba(34,197,94,0.3)"}`,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:"out"===e?r.jsx("div",{style:{fontSize:"13px",color:"#4a5f78",fontWeight:600},children:"Off the Clock"}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{style:{fontSize:"10px",color:"break"===e?"#fbbf24":"#4ade80",fontWeight:700,textTransform:"uppercase",letterSpacing:"0.5px"},children:"break"===e?"On Break":"Working"}),r.jsx("div",{style:{fontSize:"28px",fontWeight:800,color:"#e8ecf1",marginTop:"2px",fontVariantNumeric:"tabular-nums"},children:l(t)}),i&&(0,r.jsxs)("div",{style:{fontSize:"11px",color:"#4a5f78",marginTop:"2px"},children:["since ",d(new Date(i))]})]})}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px",maxWidth:"320px",margin:"0 auto"},children:["out"===e&&r.jsx("button",{onClick:o,style:{...f("#22c55e"),padding:"20px",fontSize:"18px"},children:"\uD83D\uDFE2 Clock In"}),"in"===e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{onClick:c,style:{...f("#f59e0b"),padding:"16px",fontSize:"16px"},children:"\uD83C\uDF54 Start Lunch Break"}),r.jsx("button",{onClick:x,style:{...f("#ef4444"),padding:"16px",fontSize:"16px"},children:"\uD83D\uDD34 Clock Out"})]}),"break"===e&&(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{onClick:p,style:{...f("#22c55e"),padding:"18px",fontSize:"17px"},children:"✅ End Break"}),n&&(0,r.jsxs)("div",{style:{fontSize:"12px",color:"#fbbf24",marginTop:"4px"},children:["Break started at ",d(new Date(n))]})]})]}),"out"!==e&&s.filter(e=>e.break_end).length>0&&(0,r.jsxs)("div",{style:{marginTop:"20px",textAlign:"left"},children:[r.jsx("div",{style:{fontSize:"10px",fontWeight:700,color:"#4a5f78",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"4px"},children:"Today's Breaks"}),s.filter(e=>e.break_end).map(e=>{let t=new Date(e.break_end).getTime()-new Date(e.break_start).getTime();return(0,r.jsxs)("div",{style:{fontSize:"13px",color:"#6b7a8d",padding:"4px 0"},children:[d(new Date(e.break_start))," – ",d(new Date(e.break_end)),(0,r.jsxs)("span",{style:{color:"#4a5f78"},children:[" (",l(t),")"]})]},e.id)})]})]})}function x(){let{user:e}=(0,s.a)(),[t,i]=(0,n.useState)([]),[a,c]=(0,n.useState)(!0);return((0,o.e)(),a)?r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#4a5f78"},children:"Loading..."}):(0,r.jsxs)("div",{children:[r.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"#4a5f78",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"12px"},children:"Recent Time Entries"}),0===t.length&&(0,r.jsxs)("div",{style:{textAlign:"center",padding:"32px 0",color:"#4a5f78"},children:[r.jsx("div",{style:{fontSize:"36px",marginBottom:"6px",opacity:.4},children:"⏰"}),r.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:"No time entries yet"})]}),t.map(e=>(0,r.jsxs)("div",{style:{background:"#141e2b",border:"1px solid #1e2d3d",borderRadius:"10px",padding:"12px",marginBottom:"6px"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[r.jsx("div",{style:{fontWeight:700,fontSize:"14px"},children:new Date(e.clock_in).toLocaleDateString([],{weekday:"short",month:"short",day:"numeric"})}),r.jsx("div",{style:{fontWeight:800,fontSize:"15px",color:"#60a5fa"},children:e.total_ms?l(e.total_ms):"—"})]}),(0,r.jsxs)("div",{style:{fontSize:"12px",color:"#4a5f78",marginTop:"3px"},children:[d(new Date(e.clock_in))," – ",e.clock_out?d(new Date(e.clock_out)):"active"]})]},e.id))]})}function u(){let{user:e}=(0,s.a)(),{clockStatus:t,elapsed:i}=(0,a.q)(),[d,c]=(0,n.useState)([]),[p,x]=(0,n.useState)(!0);if((0,o.e)(),p)return r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#4a5f78"},children:"Loading..."});let u=new Date,f=new Date(u);f.setDate(u.getDate()-(u.getDay()+6)%7),f.setHours(0,0,0,0);let h=Array.from({length:7},(e,r)=>{let n=new Date(f);n.setDate(f.getDate()+r);let a=d.filter(e=>new Date(e.clock_in).toDateString()===n.toDateString()).reduce((e,t)=>e+(t.total_ms||0),0);return n.toDateString()===u.toDateString()&&"out"!==t&&(a+=i),{date:n,dayName:n.toLocaleDateString([],{weekday:"short"}),totalMs:a}}),m=h.reduce((e,t)=>e+t.totalMs,0),b=Math.min(m,144e6),y=Math.max(0,m-144e6);return(0,r.jsxs)("div",{children:[r.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"#4a5f78",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"12px"},children:"This Week"}),(0,r.jsxs)("div",{style:{background:"linear-gradient(135deg, rgba(59,130,246,0.10), rgba(59,130,246,0.03))",border:"1px solid rgba(59,130,246,0.25)",borderRadius:"14px",padding:"16px",marginBottom:"16px"},children:[(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[r.jsx(g,{label:"Total",value:l(m),color:"#e8ecf1"}),r.jsx(g,{label:"Regular",value:l(b),color:"#4ade80"}),r.jsx(g,{label:"OT",value:y>0?l(y):"—",color:y>0?"#f87171":"#4a5f78"})]}),(0,r.jsxs)("div",{style:{marginTop:"12px"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"11px",marginBottom:"4px"},children:[r.jsx("span",{style:{color:"#4a5f78"},children:"Week Progress"}),(0,r.jsxs)("span",{style:{color:m>=144e6?"#f87171":"#60a5fa",fontWeight:700},children:[(m/36e5).toFixed(1)," / 40 hrs"]})]}),r.jsx("div",{style:{height:"8px",background:"#1e2d3d",borderRadius:"4px",overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${Math.min(m/144e6*100,100)}%`,background:m>=144e6?"linear-gradient(90deg, #22c55e 80%, #ef4444)":"#3b82f6",borderRadius:"4px"}})})]})]}),r.jsx("div",{style:{fontSize:"10px",fontWeight:700,color:"#4a5f78",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"8px"},children:"Daily Breakdown"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:h.map((e,t)=>{let i=e.totalMs/36e5,n=e.date.toDateString()===u.toDateString();return(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",background:n?"rgba(59,130,246,0.06)":"#141e2b",border:n?"1px solid rgba(59,130,246,0.2)":"1px solid #1e2d3d",borderRadius:"8px"},children:[r.jsx("div",{style:{width:"36px",fontSize:"12px",fontWeight:700,color:n?"#60a5fa":"#6b7a8d"},children:e.dayName}),r.jsx("div",{style:{flex:1},children:r.jsx("div",{style:{height:"10px",background:"#1e2d3d",borderRadius:"5px",overflow:"hidden"},children:r.jsx("div",{style:{height:"100%",width:`${Math.min(i/10*100,100)}%`,background:i>8?"linear-gradient(90deg, #3b82f6 80%, #f59e0b)":"#3b82f6",borderRadius:"5px"}})})}),r.jsx("div",{style:{width:"50px",textAlign:"right",fontSize:"13px",fontWeight:700,color:e.totalMs>0?"#e8ecf1":"#2a3a4f"},children:e.totalMs>0?l(e.totalMs):"—"})]},t)})})]})}function g({label:e,value:t,color:i}){return(0,r.jsxs)("div",{style:{background:"#141e2b",borderRadius:"8px",padding:"6px 10px",textAlign:"center",flex:1},children:[r.jsx("div",{style:{fontSize:"9px",color:"#4a5f78",fontWeight:600,textTransform:"uppercase"},children:e}),r.jsx("div",{style:{fontSize:"17px",fontWeight:800,color:i,marginTop:"1px"},children:t})]})}function f(e){return{width:"100%",padding:"10px",borderRadius:"10px",border:"none",background:e,color:"#fff",fontWeight:700,cursor:"pointer",fontFamily:"-apple-system, sans-serif"}}},2064:(e,t,i)=>{"use strict";i.d(t,{q:()=>d,w:()=>l});var r=i(326),n=i(7577),a=i(1944),s=i(2567);let o=(0,n.createContext)({});function l({children:e}){let{user:t}=(0,s.a)(),i=(0,a.e)(),[l,d]=(0,n.useState)("out"),[c,p]=(0,n.useState)(null),[x,u]=(0,n.useState)(null),[g,f]=(0,n.useState)([]),[h,m]=(0,n.useState)(0),[b,y]=(0,n.useState)(null),[v,j]=(0,n.useState)(null),[k,S]=(0,n.useState)(!0),D=(0,n.useCallback)(async()=>{if(!t)return;let e=new Date().toISOString(),{data:r,error:n}=await i.from("time_entries").insert({user_id:t.id,clock_in:e,status:"clocked_in"}).select().single();r&&!n&&(y(r),p(e),f([]),d("in"),m(0))},[t,i]),_=(0,n.useCallback)(async()=>{if(!b)return;let e=new Date().toISOString(),{data:t}=await i.from("time_breaks").insert({time_entry_id:b.id,break_start:e}).select().single();await i.from("time_entries").update({status:"on_break"}).eq("id",b.id),t&&(f(e=>[...e,t]),u(e),d("break"))},[b,i]),w=(0,n.useCallback)(async()=>{if(!b||!x)return;let e=new Date().toISOString(),t=g.find(e=>!e.break_end);t&&(await i.from("time_breaks").update({break_end:e}).eq("id",t.id),f(i=>i.map(i=>i.id===t.id?{...i,break_end:e}:i))),await i.from("time_entries").update({status:"clocked_in"}).eq("id",b.id),u(null),d("in")},[b,x,g,i]),P=(0,n.useCallback)(async()=>{if(!b||!c)return;let e=new Date,t=e.toISOString(),r=g.find(e=>!e.break_end);r&&await i.from("time_breaks").update({break_end:t}).eq("id",r.id);let n=e.getTime()-new Date(c).getTime();g.map(e=>({...e,break_end:e.break_end||t})).forEach(e=>{n-=new Date(e.break_end).getTime()-new Date(e.break_start).getTime()}),await i.from("time_entries").update({clock_out:t,status:"clocked_out",total_ms:Math.max(0,n)}).eq("id",b.id),d("out"),p(null),u(null),f([]),m(0),y(null)},[b,c,g,i]);return r.jsx(o.Provider,{value:{clockStatus:l,clockInTime:c,breakStartTime:x,currentBreaks:g,elapsed:h,activeTimeEntry:b,doClockIn:D,doStartBreak:_,doEndBreak:w,doClockOut:P,activePart:v,setActivePart:j,appLoading:k},children:e})}let d=()=>(0,n.useContext)(o)},2567:(e,t,i)=>{"use strict";i.d(t,{H:()=>o,a:()=>l});var r=i(326),n=i(7577),a=i(1944);let s=(0,n.createContext)({user:null,profile:null,isAdmin:!1,loading:!0,signOut:async()=>{}});function o({children:e}){let[t,i]=(0,n.useState)(null),[o,l]=(0,n.useState)(null),[d,c]=(0,n.useState)(!0),p=(0,a.e)(),x=async()=>{await p.auth.signOut(),i(null),l(null)};return r.jsx(s.Provider,{value:{user:t,profile:o,isAdmin:o?.role==="admin",loading:d,signOut:x},children:e})}let l=()=>(0,n.useContext)(s)},1944:(e,t,i)=>{"use strict";i.d(t,{e:()=>n});var r=i(861);function n(){return(0,r.createBrowserClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},8522:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});let r=(0,i(8570).createProxy)(String.raw`/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/layout.tsx#default`)},2716:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});let r=(0,i(8570).createProxy)(String.raw`/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/time/page.tsx#default`)},2029:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>s,metadata:()=>n,viewport:()=>a});var r=i(9510);i(5023);let n={title:"BMG Ops",description:"BMG Fleet Installations Operations App",manifest:"/manifest.json",appleWebApp:{capable:!0,statusBarStyle:"black-translucent",title:"BMG Ops"}},a={width:"device-width",initialScale:1,maximumScale:1,userScalable:!1,themeColor:"#0f1720"};function s({children:e}){return(0,r.jsxs)("html",{lang:"en",children:[r.jsx("head",{children:r.jsx("link",{rel:"apple-touch-icon",href:"/icon-192.png"})}),r.jsx("body",{children:e})]})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[276,471,861],()=>i(8932));module.exports=r})();