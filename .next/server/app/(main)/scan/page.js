(()=>{var e={};e.id=223,e.ids=[223],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},605:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>x,tree:()=>l}),r(9693),r(8522),r(5866),r(2029);var n=r(3191),i=r(8716),a=r(7922),o=r.n(a),s=r(5231),d={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>s[e]);r.d(t,d);let l=["",{children:["(main)",{children:["scan",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,9693)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/scan/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,8522)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,2029)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/scan/page.tsx"],p="/(main)/scan/page",u={require:r,loadChunk:()=>Promise.resolve()},x=new n.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(main)/scan/page",pathname:"/scan",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},7227:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2994,23)),Promise.resolve().then(r.t.bind(r,6114,23)),Promise.resolve().then(r.t.bind(r,9727,23)),Promise.resolve().then(r.t.bind(r,9671,23)),Promise.resolve().then(r.t.bind(r,1868,23)),Promise.resolve().then(r.t.bind(r,4759,23))},9378:(e,t,r)=>{Promise.resolve().then(r.bind(r,5236))},5946:(e,t,r)=>{Promise.resolve().then(r.bind(r,7332))},6533:()=>{},5047:(e,t,r)=>{"use strict";var n=r(7389);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},5236:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var n=r(326),i=r(2567),a=r(2064);function o({clockStatus:e,activePartNumber:t,activeEndCustomer:r}){let{profile:a,isAdmin:o}=(0,i.a)(),s="in"===e?"\uD83D\uDFE2 Clocked In":"break"===e?"\uD83D\uDFE1 On Break":t?`${t} • ${r}`:"";return(0,n.jsxs)("header",{style:{background:"#141e2b",borderBottom:"1px solid #1e2d3d",padding:"12px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",position:"sticky",top:0,zIndex:100},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,fontSize:"11px",color:"#fff"},children:"BMG"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[n.jsx("span",{style:{fontWeight:700,fontSize:"14px"},children:"BMG Ops"}),n.jsx("span",{style:{background:o?"rgba(139,92,246,0.12)":"rgba(59,130,246,0.12)",border:`1px solid ${o?"rgba(139,92,246,0.3)":"rgba(59,130,246,0.3)"}`,borderRadius:"5px",color:o?"#a78bfa":"#60a5fa",padding:"2px 6px",fontSize:"9px",fontWeight:700},children:o?"Admin":"Crew"})]}),s&&n.jsx("div",{style:{fontSize:"10px",color:"#4a5f78"},children:s})]})]}),n.jsx("div",{style:{fontSize:"11px",color:"#4a5f78"},children:a?.full_name})]})}var s=r(5047);let d=[{id:"home",path:"/home",label:"Home",icon:"\uD83C\uDFE0"},{id:"time",path:"/time",label:"Time Clock",icon:"⏰"},{id:"vehicles",path:"/vehicles",label:"Vehicles",icon:"\uD83D\uDE90"},{id:"more",path:"/more",label:"More",icon:"⋯"}];function l({clockStatus:e}){let t=(0,s.usePathname)(),r=(0,s.useRouter)(),i=t=>{if("time"===t.id){if("in"===e)return"\uD83D\uDFE2";if("break"===e)return"\uD83D\uDFE1"}return t.icon},a=e=>"/home"===e.path?"/home"===t||"/scan"===t||"/select-part"===t||"/photos"===t:t.startsWith(e.path);return n.jsx("nav",{style:{position:"fixed",bottom:0,left:0,right:0,background:"#141e2b",borderTop:"1px solid #1e2d3d",display:"flex",zIndex:100,paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:d.map(e=>(0,n.jsxs)("button",{onClick:()=>r.push(e.path),style:{flex:1,padding:"8px 4px 10px",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px",color:a(e)?"#60a5fa":"#4a5f78"},children:[n.jsx("div",{style:{fontSize:"18px"},children:i(e)}),n.jsx("div",{style:{fontSize:"10px",fontWeight:700},children:e.label})]},e.id))})}function c({children:e}){let{loading:t}=(0,i.a)(),{clockStatus:r,activePart:s,appLoading:d}=(0,a.q)();return t||d?n.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,n.jsxs)("div",{style:{textAlign:"center"},children:[n.jsx("div",{style:{width:"36px",height:"36px",border:"3px solid #1e2d3d",borderTopColor:"#3b82f6",borderRadius:"50%",margin:"0 auto",animation:"spin 1s linear infinite"}}),n.jsx("div",{style:{color:"#4a5f78",marginTop:"12px",fontSize:"13px"},children:"Loading..."})]})}):(0,n.jsxs)("div",{style:{minHeight:"100vh",paddingBottom:"70px"},children:[n.jsx(o,{clockStatus:r,activePartNumber:s?.part_number,activeEndCustomer:s?.end_customer}),n.jsx("div",{style:{maxWidth:"500px",margin:"0 auto",padding:"14px 20px"},children:e}),n.jsx(l,{clockStatus:r})]})}function p({children:e}){return n.jsx(i.H,{children:n.jsx(a.w,{children:n.jsx(c,{children:e})})})}},7332:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var n=r(326),i=r(7577),a=r(5047),o=r(1944),s=r(2064),d=r(2567);async function l(e){try{let t=new AbortController,r=setTimeout(()=>t.abort(),3e3),n=await fetch(`https://vpic.nhtsa.dot.gov/api/vehicles/decodevinvalues/${e}?format=json`,{signal:t.signal});clearTimeout(r);let i=await n.json(),a=i.Results?.[0];if(a?.Make)return{year:a.ModelYear||"",make:a.Make||"",model:a.Model||"",trim:a.Trim||"",bodyClass:a.BodyClass||"",driveType:a.DriveType||"",fuelType:a.FuelTypePrimary||"",doors:a.Doors||"",gvwr:a.GVWR||""}}catch{}return function(e){let t=e.toUpperCase(),r={A:"2010",B:"2011",C:"2012",D:"2013",E:"2014",F:"2015",G:"2016",H:"2017",J:"2018",K:"2019",L:"2020",M:"2021",N:"2022",P:"2023",R:"2024",S:"2025",T:"2026",V:"2027",W:"2028",1:"2001",2:"2002",3:"2003",4:"2004",5:"2005",6:"2006",7:"2007",8:"2008",9:"2009"}[t[9]]||"",n={"1FT":"Ford","2FT":"Ford","3FT":"Ford","1FA":"Ford","1FM":"Ford","3FA":"Ford","1FD":"Ford","1FB":"Ford","1FC":"Ford","1GC":"Chevrolet","1G1":"Chevrolet","2G1":"Chevrolet","1GT":"GMC","1GD":"GMC","1C4":"Jeep","1C6":"RAM","3C6":"RAM","2C3":"Dodge","2D7":"RAM",WDB:"Mercedes-Benz",WDD:"Mercedes-Benz",WDF:"Mercedes-Benz",WD3:"Mercedes-Benz",WD4:"Mercedes-Benz","5J6":"Honda","1HG":"Honda",JTD:"Toyota","4T1":"Toyota","5NM":"Hyundai","5XY":"Kia","1N4":"Nissan","1N6":"Nissan",WBA:"BMW",NM0:"Ford",MAJ:"Ford"}[t.substring(0,3)]||"";n||(n=({"1F":"Ford","2F":"Ford","3F":"Ford","1G":"GM","2G":"GM","1C":"Chrysler","2C":"Dodge","3C":"RAM",WD:"Mercedes-Benz",JT:"Toyota","1N":"Nissan",WB:"BMW"})[t.substring(0,2)]||"Unknown");let i="Vehicle",a="";return n.includes("Ford")?t.startsWith("1FTBW")||t.startsWith("1FTNW")?(i="Transit",a="Van"):t.startsWith("1FTBR")?(i="Transit",a="Wagon"):t.startsWith("1FTFW")||t.startsWith("1FTEW")?(i="F-150",a="Pickup"):t.startsWith("1FT7W")||t.startsWith("1FT8W")?(i="F-250/F-350",a="Pickup"):t.startsWith("3FTTW")?(i="Transit",a="Cargo Van"):t.startsWith("MAJ")?(i="Transit Connect",a="Van"):t.startsWith("NM0")&&(i="Transit",a="Van"):n.includes("RAM")||n.includes("Dodge")?"6"===t[3]?(i="ProMaster",a="Van"):(i="RAM",a="Pickup/Van"):n.includes("Mercedes")&&(i="Sprinter",a="Van"),{year:r,make:n.replace(/ \(.*\)/,""),model:i,trim:"",bodyClass:a,driveType:"",fuelType:"",doors:"",gvwr:""}}(e)}function c(e){return!!e&&17===e.length&&/^[A-HJ-NPR-Z0-9]{17}$/i.test(e)}function p(){let e=(0,a.useRouter)(),{user:t}=(0,d.a)(),{activePart:p}=(0,s.q)(),u=(0,o.e)(),[x,g]=(0,i.useState)(""),[h,f]=(0,i.useState)(""),[m,b]=(0,i.useState)(!1),[v,y]=(0,i.useState)(null),[S,j]=(0,i.useState)(!1),[_,k]=(0,i.useState)(null),[T,w]=(0,i.useState)(""),[C,D]=(0,i.useState)(""),[F,R]=(0,i.useState)("text"),[W,P]=(0,i.useState)(!1),[B,z]=(0,i.useState)(""),[A,M]=(0,i.useState)(""),[I,E]=(0,i.useState)(0),N=(0,i.useRef)(null),O=(0,i.useRef)(null),G=(0,i.useRef)(null),V=(0,i.useRef)(null),q=(0,i.useRef)(null),H=(0,i.useRef)(!1),U=(0,i.useRef)(null),J=(0,i.useRef)(0),L=()=>{q.current&&(clearInterval(q.current),q.current=null),V.current&&(V.current.getTracks().forEach(function(e){e.stop()}),V.current=null),O.current&&(O.current.srcObject=null),P(!1)},K=async()=>{z(""),H.current=!1,M(""),E(0),J.current=0;try{var e=await r.e(882).then(r.bind(r,882)),t=[e.BarcodeFormat.CODE_128,e.BarcodeFormat.CODE_39,e.BarcodeFormat.CODE_93,e.BarcodeFormat.DATA_MATRIX,e.BarcodeFormat.QR_CODE,e.BarcodeFormat.PDF_417,e.BarcodeFormat.ITF],n=new Map;n.set(e.DecodeHintType.POSSIBLE_FORMATS,t),n.set(e.DecodeHintType.TRY_HARDER,!0);var i=new e.MultiFormatReader;i.setHints(n),U.current=i;var a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}}});if(V.current=a,!O.current)return;O.current.srcObject=a,await O.current.play(),P(!0),q.current=setInterval(function(){X(e)},200)}catch(e){e?.name==="NotAllowedError"||e?.message?.includes("Permission")?z("Camera permission denied. Allow camera access in your browser settings, or use text input."):e?.name==="NotFoundError"?z("No camera found. Use text input instead."):z("Camera error: "+(e?.message||"Unknown error"))}},X=e=>{if(!H.current&&O.current&&G.current&&U.current){var t=O.current;if(t.readyState===t.HAVE_ENOUGH_DATA){var r=G.current,n=r.getContext("2d");if(n){r.width=t.videoWidth,r.height=t.videoHeight,n.drawImage(t,0,0),J.current=J.current+1,E(J.current);try{for(var i=n.getImageData(0,0,r.width,r.height),a=i.data.length/4,o=new Uint8ClampedArray(a),s=0;s<a;s++){var d=i.data[4*s],l=i.data[4*s+1],p=i.data[4*s+2];o[s]=Math.round(.299*d+.587*l+.114*p)}var u=new e.RGBLuminanceSource(o,r.width,r.height),x=new e.BinaryBitmap(new e.HybridBinarizer(u)),h=U.current.decode(x).getText().trim().toUpperCase().replace(/[^A-HJ-NPR-Z0-9]/g,"");M(h),17===h.length&&c(h)&&(H.current=!0,L(),g(h),$(h))}catch(e){}}}}},$=async e=>{f(""),b(!0);try{var t=await l(e);y({vin:e,vehicle:t})}catch(e){f("Failed to decode VIN.")}b(!1)},Y=()=>{L(),R("text")},Z=async()=>{var e=x.trim().toUpperCase();if(!c(e)){f("Invalid VIN - must be 17 characters.");return}$(e)},Q=async()=>{if(v&&t){var e=v.vin,r=v.vehicle,n=null;if(w(""),D(""),f(""),p){var{data:i}=await u.from("po_line_items").select("*, purchase_orders!inner(id, po_number, status)").eq("part_number",p.part_number).eq("purchase_orders.status","open"),a=(i||[]).find(function(e){return e.installed<e.quantity});a?(n=a.id,D("PO #"+a.purchase_orders.po_number+" ("+(a.installed+1)+"/"+a.quantity+")")):w("No open PO found for part "+p.part_number)}var o=await u.from("scanned_vehicles").insert({vin:e,vehicle_year:r.year,vehicle_make:r.make,vehicle_model:r.model,vehicle_trim:r.trim,body_class:r.bodyClass,drive_type:r.driveType,fuel_type:r.fuelType,gvwr:r.gvwr,catalog_id:p?.id||null,part_number:p?.part_number||null,customer:p?.customer||null,end_customer:p?.end_customer||null,po_line_item_id:n,scanned_by:t.id}).select().single();if(o.error){f("Failed to save: "+o.error.message);return}if(n){await u.rpc("increment_po_installed",{p_line_id:n});var s=(i||[]).find(function(e){return e.id===n});if(s){var d=s.purchase_orders.id,{data:l}=await u.from("po_line_items").select("quantity, installed").eq("po_id",d);(l||[]).every(function(e){return e.installed>=e.quantity})&&(await u.from("purchase_orders").update({status:"complete"}).eq("id",d),D(function(e){return e+" - PO COMPLETE!"}))}}k(o.data.id),j(!0)}},ee=()=>{y(null),j(!1),g(""),k(null),f(""),w(""),D(""),M(""),H.current=!1,E(0),J.current=0,R("camera"),setTimeout(function(){K()},300)};var et=v?[v.vehicle.year,v.vehicle.make,v.vehicle.model].filter(Boolean).join(" "):"";return v||m||S?m?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"60px 0"},children:[n.jsx("div",{style:{width:"36px",height:"36px",border:"3px solid #1e2d3d",borderTopColor:"#3b82f6",borderRadius:"50%",margin:"0 auto",animation:"spin 1s linear infinite"}}),n.jsx("div",{style:{color:"#93c5fd",fontWeight:600,marginTop:"12px"},children:"Decoding VIN..."})]}):S?(0,n.jsxs)("div",{style:{textAlign:"center",padding:"28px 0"},children:[n.jsx("div",{style:{width:"64px",height:"64px",borderRadius:"50%",background:T?"rgba(251,191,36,0.12)":"rgba(34,197,94,0.12)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 14px",fontSize:"30px",color:T?"#fbbf24":"#4ade80"},children:T?"!":"OK"}),n.jsx("div",{style:{fontSize:"18px",fontWeight:800},children:"Vehicle Recorded"}),n.jsx("div",{style:{color:"#6b7a8d",fontSize:"13px",marginTop:"4px"},children:et}),n.jsx("div",{style:{fontFamily:"monospace",fontSize:"11px",color:"#4a5f78"},children:v.vin}),C&&n.jsx("div",{style:{marginTop:"8px",padding:"8px 12px",background:"rgba(34,197,94,0.06)",border:"1px solid rgba(34,197,94,0.2)",borderRadius:"8px",color:"#4ade80",fontSize:"12px",fontWeight:700},children:C}),T&&n.jsx("div",{style:{marginTop:"8px",padding:"8px 12px",background:"rgba(251,191,36,0.06)",border:"1px solid rgba(251,191,36,0.2)",borderRadius:"8px",color:"#fbbf24",fontSize:"12px",fontWeight:700},children:T}),(0,n.jsxs)("div",{style:{marginTop:"20px",display:"flex",flexDirection:"column",gap:"8px"},children:[n.jsx("button",{onClick:()=>e.push("/photos?id="+_),style:{width:"100%",padding:"14px",borderRadius:"10px",background:"#8b5cf6",color:"#fff",fontWeight:800,fontSize:"14px",border:"none"},children:"Add Completion Photos"}),n.jsx("button",{onClick:()=>ee(),style:{width:"100%",padding:"16px",borderRadius:"10px",background:"#3b82f6",color:"#fff",fontWeight:800,fontSize:"16px",border:"none"},children:"Scan Next VIN"}),n.jsx("button",{onClick:()=>e.push("/home"),style:{width:"100%",padding:"10px",borderRadius:"10px",border:"1px solid #1e2d3d",background:"transparent",color:"#6b7a8d",fontSize:"13px",fontWeight:700},children:"Home"})]})]}):(0,n.jsxs)("div",{children:[n.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"#4a5f78",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"12px"},children:"Vehicle Identified"}),(0,n.jsxs)("div",{style:{background:"linear-gradient(135deg, #1a2a3f, #1e3350)",border:"1px solid #2a4a6f",borderRadius:"14px",padding:"18px",marginBottom:"12px"},children:[n.jsx("div",{style:{fontSize:"10px",color:"#4a5f78",fontWeight:600,letterSpacing:"1px",textTransform:"uppercase"},children:"VIN"}),n.jsx("div",{style:{fontSize:"13px",fontFamily:"monospace",color:"#93c5fd",fontWeight:700,letterSpacing:"1.5px",marginTop:"2px",marginBottom:"10px"},children:v.vin}),n.jsx("div",{style:{fontSize:"20px",fontWeight:800},children:et||"Unknown"}),v.vehicle.bodyClass&&n.jsx("div",{style:{fontSize:"13px",color:"#6b7a8d",marginTop:"2px"},children:v.vehicle.bodyClass})]}),p&&(0,n.jsxs)("div",{style:{background:"#141e2b",border:"1px solid #1e2d3d",borderRadius:"10px",padding:"10px 12px",marginBottom:"12px",fontSize:"12px"},children:[n.jsx("span",{style:{color:"#4a5f78"},children:"Recording as "}),n.jsx("span",{style:{fontWeight:700,color:"#60a5fa"},children:p.part_number}),(0,n.jsxs)("span",{style:{color:"#4a5f78"},children:[" - ",p.end_customer]})]}),h&&n.jsx("div",{style:{marginTop:"8px",padding:"8px 12px",background:"rgba(239,68,68,0.06)",border:"1px solid rgba(239,68,68,0.2)",borderRadius:"8px",color:"#f87171",fontSize:"12px",marginBottom:"12px"},children:h}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[n.jsx("button",{onClick:Q,style:{width:"100%",padding:"16px",borderRadius:"10px",background:"#22c55e",color:"#fff",fontSize:"16px",fontWeight:800,border:"none"},children:"Confirm - Record Vehicle"}),n.jsx("button",{onClick:()=>{y(null),g("")},style:{width:"100%",padding:"10px",borderRadius:"10px",border:"1px solid #1e2d3d",background:"transparent",color:"#6b7a8d",fontSize:"13px",fontWeight:700},children:"Scan Different VIN"})]})]}):(0,n.jsxs)("div",{children:[n.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"#4a5f78",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"12px"},children:"Scan VIN"}),p&&(0,n.jsxs)("div",{style:{background:"#141e2b",border:"1px solid #1e2d3d",borderRadius:"10px",padding:"10px 12px",marginBottom:"12px"},children:[(0,n.jsxs)("div",{style:{fontWeight:800,fontSize:"14px"},children:[p.part_number," - ",p.end_customer]}),(0,n.jsxs)("div",{style:{fontSize:"11px",color:"#4a5f78",marginTop:"1px"},children:[p.graphic_package," | ",p.vehicle_type]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"4px",marginBottom:"12px",background:"#141e2b",borderRadius:"8px",padding:"3px"},children:[n.jsx("button",{onClick:()=>{R("camera"),setTimeout(function(){K()},300)},style:{flex:1,padding:"8px",borderRadius:"6px",fontSize:"12px",fontWeight:700,background:"camera"===F?"rgba(59,130,246,0.15)":"transparent",border:"none",color:"camera"===F?"#60a5fa":"#4a5f78"},children:"Camera"}),n.jsx("button",{onClick:Y,style:{flex:1,padding:"8px",borderRadius:"6px",fontSize:"12px",fontWeight:700,background:"text"===F?"rgba(59,130,246,0.15)":"transparent",border:"none",color:"text"===F?"#60a5fa":"#4a5f78"},children:"Type / Scanner"})]}),"camera"===F?n.jsx("div",{children:B?(0,n.jsxs)("div",{style:{padding:"20px",textAlign:"center",background:"rgba(239,68,68,0.06)",border:"1px solid rgba(239,68,68,0.2)",borderRadius:"10px"},children:[n.jsx("div",{style:{color:"#f87171",fontSize:"13px",marginBottom:"12px"},children:B}),n.jsx("button",{onClick:Y,style:{padding:"10px 20px",borderRadius:"8px",background:"#3b82f6",color:"#fff",fontWeight:700,fontSize:"13px",border:"none"},children:"Switch to Text Input"})]}):(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{style:{position:"relative",borderRadius:"12px",overflow:"hidden",background:"#000",height:"300px",marginBottom:"8px"},children:[n.jsx("video",{ref:O,playsInline:!0,muted:!0,style:{width:"100%",height:"100%",objectFit:"cover"}}),n.jsx("div",{style:{position:"absolute",top:"50%",left:"3%",right:"3%",height:"70px",marginTop:"-35px",border:"3px solid rgba(59,130,246,0.8)",borderRadius:"8px",pointerEvents:"none",boxShadow:"0 0 20px rgba(59,130,246,0.3)"}}),n.jsx("div",{style:{position:"absolute",bottom:"0",left:"0",right:"0",padding:"10px",background:"rgba(0,0,0,0.7)"},children:W?(0,n.jsxs)("div",{style:{textAlign:"center"},children:[n.jsx("div",{style:{fontSize:"13px",color:"#fff",fontWeight:700},children:"Hold 4-8 in from barcode"}),A?(0,n.jsxs)("div",{style:{fontSize:"13px",color:"#fbbf24",marginTop:"3px",fontFamily:"monospace",fontWeight:800},children:["FOUND: ",A," (",A.length," chars)"]}):(0,n.jsxs)("div",{style:{fontSize:"12px",color:"#9ca3af",marginTop:"3px"},children:["Scanning... ",I," frames"]})]}):n.jsx("div",{style:{textAlign:"center",fontSize:"13px",color:"#9ca3af"},children:"Starting camera..."})})]}),n.jsx("canvas",{ref:G,style:{display:"none"}})]})}):(0,n.jsxs)("div",{children:[n.jsx("input",{ref:N,type:"text",value:x,onChange:e=>g(e.target.value.toUpperCase().replace(/[^A-HJ-NPR-Z0-9]/gi,"").slice(0,17)),placeholder:"Enter or scan 17-char VIN",maxLength:17,style:{width:"100%",padding:"10px 12px",borderRadius:"8px",border:"1px solid #1e2d3d",background:"#141e2b",color:"#e8ecf1",fontSize:"18px",letterSpacing:"2px",fontWeight:700,textAlign:"center"},onKeyDown:e=>{"Enter"===e.key&&17===x.length&&Z()}}),(0,n.jsxs)("div",{style:{textAlign:"center",marginTop:"4px",fontSize:"13px",fontWeight:600,color:17===x.length?"#22c55e":"#4a5f78"},children:[x.length,"/17 ",17===x.length?"OK":""]})]}),h&&n.jsx("div",{style:{marginTop:"8px",padding:"8px 12px",background:"rgba(239,68,68,0.06)",border:"1px solid rgba(239,68,68,0.2)",borderRadius:"8px",color:"#f87171",fontSize:"12px"},children:h}),"text"===F&&n.jsx("button",{onClick:Z,disabled:17!==x.length,style:{width:"100%",padding:"16px",borderRadius:"10px",marginTop:"14px",background:17===x.length?"#3b82f6":"#1e2d3d",color:"#fff",fontSize:"16px",fontWeight:800,opacity:17===x.length?1:.4,border:"none"},children:"Decode VIN"}),n.jsx("button",{onClick:()=>e.push("/home"),style:{width:"100%",padding:"10px",borderRadius:"10px",marginTop:"8px",border:"1px solid #1e2d3d",background:"transparent",color:"#6b7a8d",fontSize:"13px",fontWeight:700},children:"Back"})]})}},2064:(e,t,r)=>{"use strict";r.d(t,{q:()=>l,w:()=>d});var n=r(326),i=r(7577),a=r(1944),o=r(2567);let s=(0,i.createContext)({});function d({children:e}){let{user:t}=(0,o.a)(),r=(0,a.e)(),[d,l]=(0,i.useState)("out"),[c,p]=(0,i.useState)(null),[u,x]=(0,i.useState)(null),[g,h]=(0,i.useState)([]),[f,m]=(0,i.useState)(0),[b,v]=(0,i.useState)(null),[y,S]=(0,i.useState)(null),[j,_]=(0,i.useState)(!0),k=(0,i.useCallback)(async()=>{if(!t)return;let e=new Date().toISOString(),{data:n,error:i}=await r.from("time_entries").insert({user_id:t.id,clock_in:e,status:"clocked_in"}).select().single();n&&!i&&(v(n),p(e),h([]),l("in"),m(0))},[t,r]),T=(0,i.useCallback)(async()=>{if(!b)return;let e=new Date().toISOString(),{data:t}=await r.from("time_breaks").insert({time_entry_id:b.id,break_start:e}).select().single();await r.from("time_entries").update({status:"on_break"}).eq("id",b.id),t&&(h(e=>[...e,t]),x(e),l("break"))},[b,r]),w=(0,i.useCallback)(async()=>{if(!b||!u)return;let e=new Date().toISOString(),t=g.find(e=>!e.break_end);t&&(await r.from("time_breaks").update({break_end:e}).eq("id",t.id),h(r=>r.map(r=>r.id===t.id?{...r,break_end:e}:r))),await r.from("time_entries").update({status:"clocked_in"}).eq("id",b.id),x(null),l("in")},[b,u,g,r]),C=(0,i.useCallback)(async()=>{if(!b||!c)return;let e=new Date,t=e.toISOString(),n=g.find(e=>!e.break_end);n&&await r.from("time_breaks").update({break_end:t}).eq("id",n.id);let i=e.getTime()-new Date(c).getTime();g.map(e=>({...e,break_end:e.break_end||t})).forEach(e=>{i-=new Date(e.break_end).getTime()-new Date(e.break_start).getTime()}),await r.from("time_entries").update({clock_out:t,status:"clocked_out",total_ms:Math.max(0,i)}).eq("id",b.id),l("out"),p(null),x(null),h([]),m(0),v(null)},[b,c,g,r]);return n.jsx(s.Provider,{value:{clockStatus:d,clockInTime:c,breakStartTime:u,currentBreaks:g,elapsed:f,activeTimeEntry:b,doClockIn:k,doStartBreak:T,doEndBreak:w,doClockOut:C,activePart:y,setActivePart:S,appLoading:j},children:e})}let l=()=>(0,i.useContext)(s)},2567:(e,t,r)=>{"use strict";r.d(t,{H:()=>s,a:()=>d});var n=r(326),i=r(7577),a=r(1944);let o=(0,i.createContext)({user:null,profile:null,isAdmin:!1,loading:!0,signOut:async()=>{}});function s({children:e}){let[t,r]=(0,i.useState)(null),[s,d]=(0,i.useState)(null),[l,c]=(0,i.useState)(!0),p=(0,a.e)(),u=async()=>{await p.auth.signOut(),r(null),d(null)};return n.jsx(o.Provider,{value:{user:t,profile:s,isAdmin:s?.role==="admin",loading:l,signOut:u},children:e})}let d=()=>(0,i.useContext)(o)},1944:(e,t,r)=>{"use strict";r.d(t,{e:()=>i});var n=r(861);function i(){return(0,n.createBrowserClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},8522:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});let n=(0,r(8570).createProxy)(String.raw`/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/layout.tsx#default`)},9693:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n});let n=(0,r(8570).createProxy)(String.raw`/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/scan/page.tsx#default`)},2029:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o,metadata:()=>i,viewport:()=>a});var n=r(9510);r(5023);let i={title:"BMG Ops",description:"BMG Fleet Installations Operations App",manifest:"/manifest.json",appleWebApp:{capable:!0,statusBarStyle:"black-translucent",title:"BMG Ops"}},a={width:"device-width",initialScale:1,maximumScale:1,userScalable:!1,themeColor:"#0f1720"};function o({children:e}){return(0,n.jsxs)("html",{lang:"en",children:[n.jsx("head",{children:n.jsx("link",{rel:"apple-touch-icon",href:"/icon-192.png"})}),n.jsx("body",{children:e})]})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[276,471,861],()=>r(605));module.exports=n})();