(()=>{var e={};e.id=646,e.ids=[646],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>x,tree:()=>d}),n(6274),n(8522),n(5866),n(2029);var r=n(3191),i=n(8716),o=n(7922),a=n.n(o),s=n(5231),l={};for(let e in s)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>s[e]);n.d(t,l);let d=["",{children:["(main)",{children:["reports",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(n.bind(n,6274)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/reports/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(n.bind(n,8522)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(n.bind(n,2029)),"/Users/craiggeorge/Desktop/bmg-ops/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(n.t.bind(n,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/reports/page.tsx"],p="/(main)/reports/page",u={require:n,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(main)/reports/page",pathname:"/reports",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7227:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,2994,23)),Promise.resolve().then(n.t.bind(n,6114,23)),Promise.resolve().then(n.t.bind(n,9727,23)),Promise.resolve().then(n.t.bind(n,9671,23)),Promise.resolve().then(n.t.bind(n,1868,23)),Promise.resolve().then(n.t.bind(n,4759,23))},9378:(e,t,n)=>{Promise.resolve().then(n.bind(n,5236))},672:(e,t,n)=>{Promise.resolve().then(n.bind(n,5018))},6533:()=>{},5047:(e,t,n)=>{"use strict";var r=n(7389);n.o(r,"useParams")&&n.d(t,{useParams:function(){return r.useParams}}),n.o(r,"usePathname")&&n.d(t,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(t,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(t,{useSearchParams:function(){return r.useSearchParams}})},5236:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>p});var r=n(326),i=n(2567),o=n(2064);function a({clockStatus:e,activePartNumber:t,activeEndCustomer:n}){let{profile:o,isAdmin:a}=(0,i.a)(),s="in"===e?"\uD83D\uDFE2 Clocked In":"break"===e?"\uD83D\uDFE1 On Break":t?`${t} • ${n}`:"";return(0,r.jsxs)("header",{style:{background:"#141e2b",borderBottom:"1px solid #1e2d3d",padding:"12px 20px",display:"flex",alignItems:"center",justifyContent:"space-between",position:"sticky",top:0,zIndex:100},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[r.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"8px",background:"linear-gradient(135deg, #3b82f6, #1d4ed8)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:800,fontSize:"11px",color:"#fff"},children:"BMG"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px"},children:[r.jsx("span",{style:{fontWeight:700,fontSize:"14px"},children:"BMG Ops"}),r.jsx("span",{style:{background:a?"rgba(139,92,246,0.12)":"rgba(59,130,246,0.12)",border:`1px solid ${a?"rgba(139,92,246,0.3)":"rgba(59,130,246,0.3)"}`,borderRadius:"5px",color:a?"#a78bfa":"#60a5fa",padding:"2px 6px",fontSize:"9px",fontWeight:700},children:a?"Admin":"Crew"})]}),s&&r.jsx("div",{style:{fontSize:"10px",color:"#4a5f78"},children:s})]})]}),r.jsx("div",{style:{fontSize:"11px",color:"#4a5f78"},children:o?.full_name})]})}var s=n(5047);let l=[{id:"home",path:"/home",label:"Home",icon:"\uD83C\uDFE0"},{id:"time",path:"/time",label:"Time Clock",icon:"⏰"},{id:"vehicles",path:"/vehicles",label:"Vehicles",icon:"\uD83D\uDE90"},{id:"more",path:"/more",label:"More",icon:"⋯"}];function d({clockStatus:e}){let t=(0,s.usePathname)(),n=(0,s.useRouter)(),i=t=>{if("time"===t.id){if("in"===e)return"\uD83D\uDFE2";if("break"===e)return"\uD83D\uDFE1"}return t.icon},o=e=>"/home"===e.path?"/home"===t||"/scan"===t||"/select-part"===t||"/photos"===t:t.startsWith(e.path);return r.jsx("nav",{style:{position:"fixed",bottom:0,left:0,right:0,background:"#141e2b",borderTop:"1px solid #1e2d3d",display:"flex",zIndex:100,paddingBottom:"env(safe-area-inset-bottom, 0px)"},children:l.map(e=>(0,r.jsxs)("button",{onClick:()=>n.push(e.path),style:{flex:1,padding:"8px 4px 10px",display:"flex",flexDirection:"column",alignItems:"center",gap:"2px",color:o(e)?"#60a5fa":"#4a5f78"},children:[r.jsx("div",{style:{fontSize:"18px"},children:i(e)}),r.jsx("div",{style:{fontSize:"10px",fontWeight:700},children:e.label})]},e.id))})}function c({children:e}){let{loading:t}=(0,i.a)(),{clockStatus:n,activePart:s,appLoading:l}=(0,o.q)();return t||l?r.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,r.jsxs)("div",{style:{textAlign:"center"},children:[r.jsx("div",{style:{width:"36px",height:"36px",border:"3px solid #1e2d3d",borderTopColor:"#3b82f6",borderRadius:"50%",margin:"0 auto",animation:"spin 1s linear infinite"}}),r.jsx("div",{style:{color:"#4a5f78",marginTop:"12px",fontSize:"13px"},children:"Loading..."})]})}):(0,r.jsxs)("div",{style:{minHeight:"100vh",paddingBottom:"70px"},children:[r.jsx(a,{clockStatus:n,activePartNumber:s?.part_number,activeEndCustomer:s?.end_customer}),r.jsx("div",{style:{maxWidth:"500px",margin:"0 auto",padding:"14px 20px"},children:e}),r.jsx(d,{clockStatus:n})]})}function p({children:e}){return r.jsx(i.H,{children:r.jsx(o.w,{children:r.jsx(c,{children:e})})})}},5018:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>s});var r=n(326),i=n(7577),o=n(5047),a=n(1944);function s(){let e=(0,o.useRouter)(),t=(0,a.e)(),[s,l]=(0,i.useState)([]),[d,c]=(0,i.useState)(!0),[p,u]=(0,i.useState)(!1),[x,h]=(0,i.useState)(!1),[g,m]=(0,i.useState)(0),[f,b]=(0,i.useState)("pending"),[v,y]=(0,i.useState)([]),[_,w]=(0,i.useState)(!1);var S=async()=>{w(!0);var{data:e}=await t.from("scanned_vehicles").select("*").not("exported_at","is",null).order("exported_at",{ascending:!1});y(e||[]),w(!1)},j=e=>{b(e),"archive"===e&&S()},k={};s.forEach(function(e){var t=e.customer||"No Customer";k[t]||(k[t]=[]),k[t].push(e)});var D=async()=>{if(0!==s.length){u(!0);try{var e=await n.e(603).then(n.bind(n,5603)),r=new Date,i=window.location.origin,o=s.map(function(e){var t=new Date(e.scanned_at);return{VIN:e.vin,"Part Number":e.part_number||"",Customer:e.customer||"","End Customer":e.end_customer||"",Year:e.vehicle_year||"",Make:e.vehicle_make||"",Model:e.vehicle_model||"","Date Scanned":t.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),Photos:i+"/view/"+e.id}}),a=e.utils.json_to_sheet(o);a["!cols"]=[{wch:20},{wch:16},{wch:16},{wch:18},{wch:6},{wch:14},{wch:16},{wch:12},{wch:40}];var d=e.utils.book_new();e.utils.book_append_sheet(d,a,"Vehicles");var c=r.toISOString().slice(0,10);e.writeFile(d,"BMG-Export-"+c+".xlsx");var p=s.map(function(e){return e.id});await t.from("scanned_vehicles").update({exported_at:r.toISOString()}).in("id",p),m(s.length),h(!0),l([])}catch(e){console.error("Export error:",e)}u(!1)}},P=async e=>{var r=k[e];if(r&&0!==r.length){u(!0);try{var i=await n.e(603).then(n.bind(n,5603)),o=new Date,a=window.location.origin,s=r.map(function(e){var t=new Date(e.scanned_at);return{VIN:e.vin,"Part Number":e.part_number||"",Customer:e.customer||"","End Customer":e.end_customer||"",Year:e.vehicle_year||"",Make:e.vehicle_make||"",Model:e.vehicle_model||"","Date Scanned":t.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),Photos:a+"/view/"+e.id}}),d=i.utils.json_to_sheet(s);d["!cols"]=[{wch:20},{wch:16},{wch:16},{wch:18},{wch:6},{wch:14},{wch:16},{wch:12},{wch:40}];var c=i.utils.book_new();i.utils.book_append_sheet(c,d,"Vehicles");var p=e.replace(/[^a-zA-Z0-9]/g,"_"),x=o.toISOString().slice(0,10);i.writeFile(c,"BMG-"+p+"-"+x+".xlsx");var g=r.map(function(e){return e.id});await t.from("scanned_vehicles").update({exported_at:o.toISOString()}).in("id",g),l(function(e){return e.filter(function(e){return!g.includes(e.id)})}),m(r.length),h(!0),setTimeout(function(){h(!1)},3e3)}catch(e){console.error("Export error:",e)}u(!1)}},C=async e=>{try{var t=await n.e(603).then(n.bind(n,5603)),r=v.filter(function(t){return t.exported_at&&t.exported_at.slice(0,19)===e.slice(0,19)});if(0===r.length)return;var i=window.location.origin,o=r.map(function(e){var t=new Date(e.scanned_at);return{VIN:e.vin,"Part Number":e.part_number||"",Customer:e.customer||"","End Customer":e.end_customer||"",Year:e.vehicle_year||"",Make:e.vehicle_make||"",Model:e.vehicle_model||"","Date Scanned":t.toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}),Photos:i+"/view/"+e.id}}),a=t.utils.json_to_sheet(o);a["!cols"]=[{wch:20},{wch:16},{wch:16},{wch:18},{wch:6},{wch:14},{wch:16},{wch:12},{wch:40}];var s=t.utils.book_new();t.utils.book_append_sheet(s,a,"Vehicles");var l=new Date(e).toISOString().slice(0,10);t.writeFile(s,"BMG-Export-"+l+".xlsx")}catch(e){console.error("Re-download error:",e)}},z={};return(v.forEach(function(e){var t=e.exported_at?.slice(0,19)||"unknown";z[t]||(z[t]=[]),z[t].push(e)}),d)?r.jsx("div",{style:{textAlign:"center",padding:"40px",color:"#4a5f78"},children:"Loading..."}):(0,r.jsxs)("div",{children:[r.jsx("div",{style:{fontSize:"11px",fontWeight:700,color:"#4a5f78",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"12px"},children:"Reports"}),(0,r.jsxs)("div",{style:{display:"flex",gap:"4px",marginBottom:"12px",background:"#141e2b",borderRadius:"8px",padding:"3px"},children:[(0,r.jsxs)("button",{onClick:function(){j("pending")},style:{flex:1,padding:"8px",borderRadius:"6px",fontSize:"12px",fontWeight:700,background:"pending"===f?"rgba(59,130,246,0.15)":"transparent",border:"none",color:"pending"===f?"#60a5fa":"#4a5f78"},children:["Ready to Export ",s.length>0?"("+s.length+")":""]}),r.jsx("button",{onClick:function(){j("archive")},style:{flex:1,padding:"8px",borderRadius:"6px",fontSize:"12px",fontWeight:700,background:"archive"===f?"rgba(59,130,246,0.15)":"transparent",border:"none",color:"archive"===f?"#60a5fa":"#4a5f78"},children:"Archive"})]}),x&&(0,r.jsxs)("div",{style:{padding:"10px 12px",background:"rgba(34,197,94,0.06)",border:"1px solid rgba(34,197,94,0.2)",borderRadius:"8px",color:"#4ade80",fontSize:"13px",fontWeight:700,marginBottom:"12px",textAlign:"center"},children:["Exported ",g," vehicles"]}),"pending"===f&&(0,r.jsxs)("div",{children:[0===s.length&&!x&&(0,r.jsxs)("div",{style:{textAlign:"center",padding:"32px 0",color:"#4a5f78"},children:[r.jsx("div",{style:{fontSize:"36px",marginBottom:"6px",opacity:.4},children:"✓"}),r.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:"All caught up - nothing to export"})]}),s.length>0&&(0,r.jsxs)("div",{children:[r.jsx("button",{onClick:D,disabled:p,style:{width:"100%",padding:"14px",borderRadius:"10px",background:"#22c55e",color:"#fff",fontSize:"15px",fontWeight:800,border:"none",marginBottom:"12px"},children:p?"Exporting...":"Export All ("+s.length+" vehicles)"}),Object.keys(k).map(function(e){var t=k[e];return(0,r.jsxs)("div",{style:{background:"#141e2b",border:"1px solid #1e2d3d",borderRadius:"10px",padding:"12px",marginBottom:"8px"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"},children:[(0,r.jsxs)("div",{children:[r.jsx("div",{style:{fontWeight:800,fontSize:"14px"},children:e}),(0,r.jsxs)("div",{style:{fontSize:"11px",color:"#4a5f78",marginTop:"1px"},children:[t.length," vehicle",1!==t.length?"s":""]})]}),r.jsx("button",{onClick:function(){P(e)},disabled:p,style:{padding:"8px 14px",borderRadius:"8px",background:"#3b82f6",color:"#fff",fontSize:"12px",fontWeight:700,border:"none"},children:"Export"})]}),t.slice(0,5).map(function(e){var t=[e.vehicle_year,e.vehicle_make,e.vehicle_model].filter(Boolean).join(" ")||"Unknown";return(0,r.jsxs)("div",{style:{padding:"4px 0",fontSize:"11px",borderTop:"1px solid rgba(30,45,61,0.5)"},children:[r.jsx("span",{style:{fontWeight:600,color:"#e8ecf1"},children:t}),r.jsx("span",{style:{color:"#4a5f78",marginLeft:"6px",fontFamily:"monospace",fontSize:"10px"},children:e.vin}),e.part_number&&r.jsx("span",{style:{color:"#93c5fd",marginLeft:"6px",fontSize:"10px"},children:e.part_number})]},e.id)}),t.length>5&&(0,r.jsxs)("div",{style:{fontSize:"10px",color:"#4a5f78",marginTop:"4px"},children:["+ ",t.length-5," more"]})]},e)})]})]}),"archive"===f&&r.jsx("div",{children:_?r.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#4a5f78"},children:"Loading archive..."}):0===Object.keys(z).length?(0,r.jsxs)("div",{style:{textAlign:"center",padding:"32px 0",color:"#4a5f78"},children:[r.jsx("div",{style:{fontSize:"36px",marginBottom:"6px",opacity:.4},children:"\uD83D\uDCC1"}),r.jsx("div",{style:{fontWeight:600,fontSize:"13px"},children:"No exports yet"})]}):Object.keys(z).map(function(e){var t=z[e],n=new Date(e),i=Array.from(new Set(t.map(function(e){return e.customer||"Unknown"})));return r.jsx("div",{style:{background:"#141e2b",border:"1px solid #1e2d3d",borderRadius:"10px",padding:"12px",marginBottom:"8px"},children:(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{style:{fontWeight:700,fontSize:"13px"},children:[n.toLocaleDateString([],{month:"short",day:"numeric",year:"numeric"})," at ",n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),(0,r.jsxs)("div",{style:{fontSize:"11px",color:"#4a5f78",marginTop:"2px"},children:[t.length," vehicles — ",i.join(", ")]})]}),r.jsx("button",{onClick:function(){C(e)},style:{padding:"8px 14px",borderRadius:"8px",background:"rgba(59,130,246,0.08)",border:"1px solid rgba(59,130,246,0.25)",color:"#60a5fa",fontSize:"12px",fontWeight:700},children:"Re-download"})]})},e)})}),r.jsx("button",{onClick:function(){e.push("/more")},style:{width:"100%",padding:"10px",borderRadius:"10px",marginTop:"12px",border:"1px solid #1e2d3d",background:"transparent",color:"#6b7a8d",fontSize:"13px",fontWeight:700},children:"Back"})]})}},2064:(e,t,n)=>{"use strict";n.d(t,{q:()=>d,w:()=>l});var r=n(326),i=n(7577),o=n(1944),a=n(2567);let s=(0,i.createContext)({});function l({children:e}){let{user:t}=(0,a.a)(),n=(0,o.e)(),[l,d]=(0,i.useState)("out"),[c,p]=(0,i.useState)(null),[u,x]=(0,i.useState)(null),[h,g]=(0,i.useState)([]),[m,f]=(0,i.useState)(0),[b,v]=(0,i.useState)(null),[y,_]=(0,i.useState)(null),[w,S]=(0,i.useState)(!0),j=(0,i.useCallback)(async()=>{if(!t)return;let e=new Date().toISOString(),{data:r,error:i}=await n.from("time_entries").insert({user_id:t.id,clock_in:e,status:"clocked_in"}).select().single();r&&!i&&(v(r),p(e),g([]),d("in"),f(0))},[t,n]),k=(0,i.useCallback)(async()=>{if(!b)return;let e=new Date().toISOString(),{data:t}=await n.from("time_breaks").insert({time_entry_id:b.id,break_start:e}).select().single();await n.from("time_entries").update({status:"on_break"}).eq("id",b.id),t&&(g(e=>[...e,t]),x(e),d("break"))},[b,n]),D=(0,i.useCallback)(async()=>{if(!b||!u)return;let e=new Date().toISOString(),t=h.find(e=>!e.break_end);t&&(await n.from("time_breaks").update({break_end:e}).eq("id",t.id),g(n=>n.map(n=>n.id===t.id?{...n,break_end:e}:n))),await n.from("time_entries").update({status:"clocked_in"}).eq("id",b.id),x(null),d("in")},[b,u,h,n]),P=(0,i.useCallback)(async()=>{if(!b||!c)return;let e=new Date,t=e.toISOString(),r=h.find(e=>!e.break_end);r&&await n.from("time_breaks").update({break_end:t}).eq("id",r.id);let i=e.getTime()-new Date(c).getTime();h.map(e=>({...e,break_end:e.break_end||t})).forEach(e=>{i-=new Date(e.break_end).getTime()-new Date(e.break_start).getTime()}),await n.from("time_entries").update({clock_out:t,status:"clocked_out",total_ms:Math.max(0,i)}).eq("id",b.id),d("out"),p(null),x(null),g([]),f(0),v(null)},[b,c,h,n]);return r.jsx(s.Provider,{value:{clockStatus:l,clockInTime:c,breakStartTime:u,currentBreaks:h,elapsed:m,activeTimeEntry:b,doClockIn:j,doStartBreak:k,doEndBreak:D,doClockOut:P,activePart:y,setActivePart:_,appLoading:w},children:e})}let d=()=>(0,i.useContext)(s)},2567:(e,t,n)=>{"use strict";n.d(t,{H:()=>s,a:()=>l});var r=n(326),i=n(7577),o=n(1944);let a=(0,i.createContext)({user:null,profile:null,isAdmin:!1,loading:!0,signOut:async()=>{}});function s({children:e}){let[t,n]=(0,i.useState)(null),[s,l]=(0,i.useState)(null),[d,c]=(0,i.useState)(!0),p=(0,o.e)(),u=async()=>{await p.auth.signOut(),n(null),l(null)};return r.jsx(a.Provider,{value:{user:t,profile:s,isAdmin:s?.role==="admin",loading:d,signOut:u},children:e})}let l=()=>(0,i.useContext)(a)},1944:(e,t,n)=>{"use strict";n.d(t,{e:()=>i});var r=n(861);function i(){return(0,r.createBrowserClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},8522:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});let r=(0,n(8570).createProxy)(String.raw`/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/layout.tsx#default`)},6274:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});let r=(0,n(8570).createProxy)(String.raw`/Users/craiggeorge/Desktop/bmg-ops/src/app/(main)/reports/page.tsx#default`)},2029:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a,metadata:()=>i,viewport:()=>o});var r=n(9510);n(5023);let i={title:"BMG Ops",description:"BMG Fleet Installations Operations App",manifest:"/manifest.json",appleWebApp:{capable:!0,statusBarStyle:"black-translucent",title:"BMG Ops"}},o={width:"device-width",initialScale:1,maximumScale:1,userScalable:!1,themeColor:"#0f1720"};function a({children:e}){return(0,r.jsxs)("html",{lang:"en",children:[r.jsx("head",{children:r.jsx("link",{rel:"apple-touch-icon",href:"/icon-192.png"})}),r.jsx("body",{children:e})]})}},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[276,471,861],()=>n(7635));module.exports=r})();